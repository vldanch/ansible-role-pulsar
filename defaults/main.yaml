---
# Installation variables

pulsar_version: 4.0.1
pulsar_cluster_name: pulsar-cluster
# pulsar_web_service_url: ansible-hostname
pulsar_web_service_url_1: ansible-hostname
pulsar_web_service_url_2: ansible-hostname
pulsar_web_service_url_3: ansible-hostname
pulsar_web_service_port: 8080
# pulsar_web_service_url_tls: ansible-hostname
pulsar_web_service_url_tls_1: ansible-hostname
pulsar_web_service_url_tls_2: ansible-hostname
pulsar_web_service_url_tls_3: ansible-hostname
pulsar_web_service_tls_port: 8443
# pulsar_broker_service_url: ansible-hostname
pulsar_broker_service_1: ansible-hostname
pulsar_broker_service_2: ansible-hostname
pulsar_broker_service_3: ansible-hostname
pulsar_broker_service_port: 6650
# pulsar_broker_service_url_tls: ansible-hostname
pulsar_broker_service_url_tls_1: ansible-hostname
pulsar_broker_service_url_tls_2: ansible-hostname
pulsar_broker_service_url_tls_3: ansible-hostname
pulsar_broker_service_tls_port: 6651
pulsar_zk_server_1: ansible-hostname
pulsar_zk_server_2: ansible-hostname
pulsar_zk_server_3: ansible-hostname
pulsar_zk_port: 2184
pulsar_bookie_port: 3181
pulsar_bookie_journal_directories: /tmp/bk-journal
pulsar_bookie_journal_directory: data/bookkeeper/journal
pulsar_bookie_allow_multiple_dirs_under_same_disk_partition: false
pulsar_bookie_min_usable_size_for_index_file_creation: 1073741824
pulsar_bookie_listening_interface: eth0
pulsar_bookie_advertised_address: ansible_host # Must use ansible_host of playbooks
pulsar_bookie_allow_loopback: false
pulsar_bookie_death_watch_interval: 1000
pulsar_bookie_flush_interval: 60000
pulsar_bookie_allow_storage_expansion: false
pulsar_bookie_use_host_name_as_bookie_id: false
pulsar_bookie_bookie_id: ""
pulsar_bookie_allow_ephemeral_ports: false
pulsar_bookie_enable_local_transport: false
pulsar_bookie_disable_server_socket_bind: false
pulsar_bookie_skip_list_arena_chunk_size: 4194304
pulsar_bookie_skip_list_arena_max_alloc_size: 131072
pulsar_bookie_bookie_auth_provider_factory_class: null
pulsar_bookie_gc_wait_time: 900000
pulsar_bookie_gc_overreplicated_ledger_wait_time: 86400000
pulsar_bookie_num_add_worker_threads: 0
pulsar_bookie_num_read_worker_threads: 8
pulsar_bookie_num_high_priority_worker_threads: 8
pulsar_bookie_max_pending_read_requests_per_thread: 2500
pulsar_bookie_max_pending_add_requests_per_thread: 10000
pulsar_bookie_read_worker_threads_throttling_enabled: true
pulsar_bookie_enable_busy_wait: false
pulsar_bookie_is_force_gc_allow_when_no_space: false
pulsar_bookie_verify_metadata_on_gc: false
pulsar_bookie_force_allow_compaction: true
pulsar_bookie_tls_provider: OpenSSL
pulsar_bookie_tls_provider_factory_class: org.apache.bookkeeper.tls.TLSContextFactory
pulsar_bookie_tls_client_authentication: true
pulsar_bookie_tls_key_store_type: JKS
pulsar_bookie_tls_key_store: null
pulsar_bookie_tls_key_store_password_path: null
pulsar_bookie_tls_trust_store_type: null
pulsar_bookie_tls_trust_store: null
pulsar_bookie_tls_trust_store_password_path: null
pulsar_bookie_num_long_poll_worker_threads: 10
pulsar_bookie_request_timer_tick_duration_ms: 10
pulsar_bookie_request_timer_num_ticks: 1024
pulsar_bookie_auditor_periodic_bookie_check_interval: 86400
pulsar_bookie_rereplication_entry_batch_size: 100
pulsar_bookie_sticky_read_s_enabled: true
pulsar_bookie_reorder_read_sequence_enabled: true
pulsar_bookie_open_ledger_rereplication_grace_period: 30000
pulsar_bookie_auto_recovery_daemon_enabled: true
pulsar_bookie_lost_bookie_recovery_delay: 0
pulsar_bookie_use_v2_wire_protocol: true
pulsar_bookie_server_tcp_no_delay: true
pulsar_bookie_server_sock_keepalive: true
pulsar_bookie_server_tcp_linger: 0
pulsar_bookie_byte_buf_allocator_size_initial: 65536
pulsar_bookie_byte_buf_allocator_size_min: 65536
pulsar_bookie_byte_buf_allocator_size_max: 1048576
pulsar_bookie_netty_max_frame_size_bytes: 5253120
pulsar_bookie_journal_format_version_to_write: 5
pulsar_bookie_journal_max_size_mb: 2048
pulsar_bookie_journal_max_backups: 5
pulsar_bookie_journal_pre_alloc_size_mb: 16
pulsar_bookie_journal_write_buffer_size_kb: 64
pulsar_bookie_journal_remove_from_page_cache: true
pulsar_bookie_journal_write_data: true
pulsar_bookie_journal_sync_data: true
pulsar_bookie_journal_adaptive_group_writes: true
pulsar_bookie_journal_max_group_wait_m_sec: 1
pulsar_bookie_journal_buffered_writes_threshold: 524288
pulsar_bookie_num_journal_callback_threads: 8
pulsar_bookie_journal_alignment_size: 4096
pulsar_bookie_journal_buffered_entries_threshold: 0
pulsar_bookie_journal_flush_when_queue_empty: false
pulsar_bookie_ledger_storage_class: org.apache.bookkeeper.bookie.storage.ldb.DbLedgerStorage
pulsar_bookie_ledger_directories: data/bookkeeper/ledgers
pulsar_bookie_index_directories: data/bookkeeper/ledgers
pulsar_bookie_auditor_periodic_check_interval: 604800
pulsar_bookie_sorted_ledger_storage_enabled: true
pulsar_bookie_skip_list_size_limit: 67108864L
pulsar_bookie_open_file_limit: 0
pulsar_bookie_file_info_format_version_to_write: 0
pulsar_bookie_page_size: 8192
pulsar_bookie_page_limit: 0
pulsar_bookie_zk_ledgers_root_path: /ledgers
pulsar_bookie_log_size_limit: 1073741824
pulsar_bookie_entry_log_file_preallocation_enabled: true
pulsar_bookie_flush_entry_log_bytes: 33554432
pulsar_bookie_read_buffer_size_bytes: 4096
pulsar_bookie_write_buffer_size_bytes: 65536
pulsar_bookie_compaction_rate: 1000
pulsar_bookie_entry_log_per_ledger_enabled: false
pulsar_bookie_use_short_host_name: false
pulsar_bookie_minor_compaction_threshold: 0.2
pulsar_bookie_minor_compaction_interval: 3600
pulsar_bookie_compaction_max_outstanding_requests: 100000
pulsar_bookie_major_compaction_threshold: 0.5
pulsar_bookie_major_compaction_interval: 86400
pulsar_bookie_is_throttle_by_bytes: false
pulsar_bookie_compaction_rate_by_entries: 1000
pulsar_bookie_compaction_rate_by_bytes: 1000000
pulsar_bookie_enable_statistics: true
pulsar_bookie_stats_provider_class: org.apache.bookkeeper.stats.prometheus.PrometheusMetricsProvider
pulsar_bookie_prometheus_stats_http_port: 8000
pulsar_bookie_read_only_mode_enabled: true
pulsar_bookie_force_read_only_bookie: false
pulsar_bookie_persist_bookie_status_enabled: false
pulsar_bookie_disk_usage_threshold: 0.95
pulsar_bookie_disk_usage_warn_threshold: 0.90
pulsar_bookie_disk_usage_lwm_threshold: 0.95
pulsar_bookie_disk_check_interval: 10000
pulsar_bookie_ledger_manager_factory_class: org.apache.bookkeeper.meta.HierarchicalLedgerManagerFactory
pulsar_bookie_ledger_manager_type: hierarchical
pulsar_bookie_allow_shaded_ledger_manager_factory_class: false
pulsar_bookie_shaded_ledger_manager_factory_class_prefix: dlshade.
pulsar_bookie_zk_timeout: 30000
pulsar_bookie_zk_retry_backoff_start_ms: 1000
pulsar_bookie_zk_retry_backoff_max_ms: 10000
pulsar_bookie_zk_enable_security: false
pulsar_bookie_http_server_enabled: false
pulsar_bookie_http_server_port: 8000
pulsar_bookie_http_server_class: org.apache.bookkeeper.http.vertx.VertxHttpServer
pulsar_bookie_db_storage_write_cache_max_size_mb: ""
pulsar_bookie_db_storage_read_ahead_cache_max_size_mb: ""
pulsar_bookie_db_storage_read_ahead_cache_batch_size: 1000
pulsar_bookie_db_storage_rocks_db_block_cache_size: ""
pulsar_bookie_db_storage_rocks_db_write_buffer_size_mb: 64
pulsar_bookie_db_storage_rocks_db_sst_size_in_mb: 64
pulsar_bookie_db_storage_rocks_db_block_size: 65536
pulsar_bookie_db_storage_rocks_db_bloom_filter_bits_per_key: 10
pulsar_bookie_db_storage_rocks_db_num_levels: -1
pulsar_bookie_db_storage_rocks_db_num_files_in_level_0: 4
pulsar_bookie_db_storage_rocks_db_max_size_in_level_1_mb: 256
pulsar_zk_chroot_path: chroot-path
# wget 'https://www.apache.org/dyn/mirrors/mirrors.cgi?action=download&filename=pulsar/pulsar-4.0.1/apache-pulsar-4.0.1-bin.tar.gz' -O apache-pulsar-4.0.1-bin.tar.gz
pulsar_mirror: https://www.apache.org/dyn/mirrors/mirrors.cgi?action=download&filename=pulsar/
pulsar_package: apache-pulsar-{{ pulsar_version }}-bin.tar.gz

pulsar_create_user_group: true
pulsar_group: pulsar
pulsar_user: pulsar

pulsar_root_dir: /usr/share
pulsar_install_dir: '{{ pulsar_root_dir }}/apache-pulsar-{{ pulsar_version }}'
# The pulsar_dir is created as a symlik to the actual installation directory.
# All other configuration and variables use the symlinked directory.
pulsar_dir: '{{ pulsar_root_dir }}/pulsar'
pulsar_log_dir: /var/log/pulsar

# Start bookkeeper after installation
bookkeeper_start: yes
# Restart bookkeeper on configuration change
bookkeeper_restart: yes

# Start broker after installation
broker_start: yes
# Restart broker on configuration change
broker_restart: yes
